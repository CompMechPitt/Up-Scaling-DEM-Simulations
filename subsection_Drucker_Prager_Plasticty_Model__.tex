\subsection{Drucker-Prager Plasticty Model With Ductile Damage}
the Drucker-Prager plasticity model was developed by by \citet{drucker_implications_1950} for modeling frictional materials like granular soils and rock. These materials tend  to exhibit pressure dependent yielding (as confining
pressure increases, so does the strength of the rock) which was incorporated as a pressure dependent yield criterion in the Drucker-Prager plasticity model. 

Specifically, the Drucker-Prager material model is formulated and used for materials of which the compressive yield strength is much greater than the tensile yield strength such as one would find in soils and rocks. Howewver, one drawback with this material model is that it is intended to simulate material response under essentially monotonic loading which limits the potential of modeling cyclic loading tonight.

In addition, the Drucker-Prager model is suitable for using in conjunction with progressive damage and failure models. In this formulation, the Johnson-Cook Damage model is used to model the ductile damage of the rock mass \cite{johnson_fracture_1985}. At a sufficiently large scale, the damage behaviour of NFR can be thought of as behaving in a ductile capacity. 

The elastic response of the material can be fully characterized with just Young's modulus, $E$, and Poisson's ratio $\nu$. Assuming plane strain conditions

Furthermore, the plasticity models used here are assumed to comprise of three key components: The yield function, the flow rule and the hardening rule. The yield function indicates whether or not the material has experienced yield given a particular stress state. The yield function varies between the two models but can be written in general as a function of effective stress and equivalent plastic strain:

\begin{equation}
F\left(\bar{\sigma}_{ij}, \bar{\epsilon}^{pl}\right)=t-p\left(\bar{\sigma}_{ij}\right)\tan\beta -d
\label{eqn:const8c}
\end{equation}

where $d$ is the cohesion:
\begin{equation}
d=\left(1-\frac{1}{3}\tan\beta \right)\sigma^y
\label{eqn:const9}
\end{equation}

and $t$ is:
\begin{equation}
t=\frac{1}{2}q\left(\bar{\sigma}_{ij}\right)\left [ 1+\frac{1}{K}-\left ( 1-\frac{1}{K} \right )\left ( \frac{r\left(\bar{\sigma}_{ij}\right)}{q\left(\bar{\sigma}_{ij}\right)} \right )^3 \right ]
\label{eqn:const10}
\end{equation}

The flow potential follows a similar form. associated if dilation angle and friction angle are equivalent:

\begin{equation}
G\left(\bar{\sigma}_{ij}\right)=t-p\left(\bar{\sigma}_{ij}\right)\tan\psi\label{eqn:const11}
\end{equation}

Where $\psi$ is the dilation angle of the material, $\sigma^{iy}$ is the initial yield stress, $\varepsilon$ is the eccentricity of the flow potential, while $p$ and $q$ stress invariants represent the mises equivalent stress and the equivalent pressure stress (hydrostatic stress) and are defined as follows:

\begin{equation}
%-\frac{1}{3}tr\left(\boldsymbol{\sigma}\right)
p\left(\bar{\sigma}_{ij}\right)=\frac{1}{3}\bar{\sigma}_{kk}
\label{eqn:druc3}
\end{equation}

\begin{equation}
%\sqrt{\frac{3}{2}}\left(\mathbf{S}:\mathbf{S}\right)
q\left(\bar{\sigma}_{ij}\right)=\sqrt{\frac{3}{2}S_{ij}S_{ji}}\label{eqn:druc4}
\end{equation}

Where $S_{ij}$ is known as the stress deviator with $\delta_{ij}$ being the Kronecker Delta:

\begin{equation}
%\mathbf{S}=\boldsymbol{\sigma}+p\mathbf{I}
S_{ij} = \bar{\sigma_{ij}} + p\left(\bar{\sigma}_{ij}\right)\delta_{ij}
\label{eqn:druc4-1}
\end{equation}

the third invariant of deviatoric stress is key. ommiting this gives less desireable results:

\begin{equation}
%\mathbf{S}=\boldsymbol{\sigma}+p\mathbf{I}
r\left(\bar{\sigma}_{ij}\right)= \sqrt[3]{\frac{9}{2}S_{ij} S_{jk} S_{ki}}
\label{eqn:druc4-2}
\end{equation}

In addition to the yield function and the flow rule, the hardening rule is prescribed to govern the increase/decrease in yield stress as the plastic strain increases. More specifically, the hardening function, $h$, in these models is used to relate the equivalent plastic strain, $\bar{\epsilon}^{pl}$,  to the plastic strain in rate form: 

The Barcelona model takes the following form in order to capture the key hardening and softening behaviour of the material, and can be written in terms of the initial compressive yield strength $\sigma_c^{iy}$, and two material parameters, $\alpha$ and $\beta$:

\begin{equation}
%\sigma_{c}\left(\bar{\epsilon}^{in}\right)=\frac{\sigma_{c}^{iy}-\sigma_{c}^{p}}{\left(\epsilon_{c}^{pp}\right)^{2}}\left(\bar{\epsilon}^{in}-\epsilon_{c}^{pp}\right)^{2}+\sigma_{c}^{p}
\sigma_c=\sigma_c^{iy}\left [ \left ( 1+\alpha \right ) e^{-\beta\bar{\epsilon}^{pl}}-\alpha e^{-2\beta\bar{\epsilon}^{pl}}  \right ]
\label{eqn:param2-1}
\end{equation}

It was found to be useful when applying bounding limits for the parameters to manipulate \ref{eqn:param2-1} to allow for the governing parameters to have a physical meaning. As such, $\alpha$ and $\beta$ can be rewritten in terms of the peak compressive yield strength, $\sigma_{c}^{p}$, and the plastic strain at the peak compressive yield strength, $\epsilon_c^{pp}$:

\begin{equation}
\beta=\frac{\ln\left[\frac{2\alpha}{1+\alpha} \right ]}{\epsilon_c^{pp}}
\label{eqn:param2-2}
\end{equation}

\begin{equation}
\alpha =\frac{2\sigma_c^{p}-\sigma_c^{iy}+2\sqrt{-\sigma_c^p\left(\sigma_c^{iy}-\sigma_c^p \right )}}{\sigma_c^{iy}}
\label{eqn:param2-3}
\end{equation}

Here, the compressive yield stress, $\sigma_{c}$, is written as function
of the inelastic strain, $\bar{\epsilon}^{in}$, and three additional
parameters. The three parameters are the initial compressive yield
stress ($\sigma_{c}^{iy}$), the peak compressive yield stress ($\sigma_{c}^{p}$),
and the plastic strain at the peak compressive yield stress ($\sigma_{c}^{iy}$).
The physical significance of each of these parameters can be seen
in Fig \ref{fig:conccomp}, where they define the y-intercept and the peak of the curve..
etc..

For the damage models, the damage initiation criteria and evolution equations are different for each material model. In general though, the damage initiation criteria for both material models is strain based and the nature of the damage evolution is assumed to be a function of the effective stress, and the equivalent plastic strain:
\begin{equation}
D=D\left(\bar{\sigma}_{ij},\bar{\epsilon}^{pl}\right)\label{eqn:const8}
\end{equation}


The damage initiation criterion for this material model was based off of the Johnson-Cook model of damage initiation \cite{Johnson_1985}. For this model, a ductile damage formulation was assumed. At large confining pressures at large scale, the damage behaviour of rock can be considered to be behaving in a ductile capacity. More specifically, the Johnson-Cook model assumes the equivalent plastic strain when damage is initiated is a function of triaxiality, $\eta$:

Because the expected loading for these geomaterials does not have a high degree of thermal variance and the loading tends to be very slow, isothermal conditions and negligible strain rate effects are assumed to yield the following form of the Johnson-Cook damage initiation model:

\begin{equation}
\bar{\epsilon}_{f}^{pl}\left(\eta\right)=\left[D_{1}+D_{2}e^{D_{3}\eta}\right]\label{eqn:druc8}
\end{equation}

After the material has experienced yield and material damage has occurred, the stress-strain relationship becomes strongly mesh-dependant due to strain localization due to the energy dissipation decreasing as the mesh is refined. As such, \citet{Hillerborg_1976} proposed a stress-displacement response based on fracture energy after damage initiation. The effective plastic strain rate is related to the plastic displacement rate, $\dot{\bar{u}}^{pl}$, by the characteristic element length, $L$, as follows:

\begin{equation}
\dot{\bar{u}}^{pl}=L\dot{\bar{\epsilon}}^{pl}\label{eqn:druc9}
\end{equation}

The damage evolution model used in this constitutive model assumes that damage is a progressively linear degradation of the material stiffness in compression.  Here, a mesh independent measure of the plastic displacement, $\bar{u}^{pl}$ is used to to govern the evolution of damage to make the formulation more universal:


Assuming a linear form, the plastic displacement when the material is completely damaged, $(\bar{u}^{pl}_f)$, can be specified, and the damage evolution can then be written as:

\begin{equation}
\dot{D}=\frac{L\dot{\bar{\epsilon}}^{pl}}{\dot{\bar{u}}_{f}^{pl}}=\frac{\dot{\bar{u}}^{pl}}{\dot{\bar{u}}_{f}^{pl}}\label{eqn:druc9-1}
\end{equation}

