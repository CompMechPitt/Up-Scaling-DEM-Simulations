\subsection{Drucker-Prager Plasticty Model With Ductile Damage}
The Drucker-Prager plasticity model was developed by by \citet{drucker_implications_1950} for modeling frictional materials like granular soils and rock. An important aspect of this plasticity model is the use of a pressure dependant yield criterion to account for the increase in yield stress of geomaterials as the in-situ stresses increase. Specifically, the Drucker-Prager material model is formulated and used for materials of which the compressive yield strength is much greater than the tensile yield strength such as one would find in soils and rocks. However, this material model is intended to simulate the material response under essentially monotonic loading which limits the capacity of modeling cyclic loading.

In addition, the Drucker-Prager model is suitable for using in conjunction with progressive damage and failure models. In this formulation, the Johnson-Cook Damage model is used to model the damage evolution of the rock mass \cite{johnson_fracture_1985}. At a sufficiently large scale, the damage behaviour of NFR can be thought of as behaving in a ductile capacity. 

Here, for the extended Drucker-Prager plasticity model, a linear yield function, $F\left(\bar{\sigma}_{ij}\right)$, is assumed to be a function of three stress invariants: the Von-Mises equivalent stress, $p\left(\bar{\sigma}_{ij}\right)$, the hydrostatic stress, $q\left(\bar{\sigma}_{ij}\right)$, and the third invariant of deviatoric stress, $r\left(\bar{\sigma}_{ij}\right)$. In addition, the yield function is written in terms of the compressive yield stress, $\sigma_c^y$, which is defined by the hardening function and two material parameters: the friction angle, $\phi$, a parameter $K$, defined as the ratio of the yield stress in triaxial tension to the yield stress in triaxial compression:

\begin{equation}
F\left(\bar{\sigma}_{ij}, \bar{\epsilon}^{pl}\right)=\frac{1}{2}q\left(\bar{\sigma}_{ij}\right)\left [ 1+\frac{1}{K}-\left ( 1-\frac{1}{K} \right )\left ( \frac{r\left(\bar{\sigma}_{ij}\right)}{q\left(\bar{\sigma}_{ij}\right)} \right )^3 \right ]-p\left(\bar{\sigma}_{ij}\right)\tan\phi - \left(1-\frac{1}{3}\tan\phi \right)\sigma_c^y
\label{eqn:const8c}
\end{equation}

%The hydrostatic stress:
%\begin{equation}
%p\left(\bar{\sigma}_{ij}\right)=\frac{1}{3}\bar{\sigma}_{kk}
%\label{eqn:druc3}
%\end{equation}

%The Von-Mises equivalent stress:
%\begin{equation}
%q\left(\bar{\sigma}_{ij}\right)=\sqrt{\frac{3}{2}S_{ij}S_{ji}}\label{eqn:druc4}
%\end{equation}

%Where $S_{ij}$ is known as the stress deviator with $\delta_{ij}$ being the Kronecker Delta:

%\begin{equation}
%S_{ij} = \bar{\sigma_{ij}} + p\left(\bar{\sigma}_{ij}\right)\delta_{ij}
%\label{eqn:druc4-1}
%\end{equation}

%The third invariant of deviatoric stress:

%\begin{equation}
%r\left(\bar{\sigma}_{ij}\right)= \sqrt[3]{\frac{9}{2}S_{ij} S_{jk} S_{ki}}
%\label{eqn:druc4-2}
%\end{equation}

The flow rule in this formulation is non-associated but the flow potential function, $G\left(\bar{\sigma}_{ij}\right)$, is written in a very similar form as the yield function with dilation angle, $\psi$, in place of the friction angle. Like with the yield function, the flow potential function, is written in terms of three stress invariants and two material parameters, dilation angle and $K$:

\begin{equation}
G\left(\bar{\sigma}_{ij}\right)=\frac{1}{2}q\left(\bar{\sigma}_{ij}\right)\left [ 1+\frac{1}{K}-\left ( 1-\frac{1}{K} \right )\left ( \frac{r\left(\bar{\sigma}_{ij}\right)}{q\left(\bar{\sigma}_{ij}\right)} \right )^3 \right ]-p\left(\bar{\sigma}_{ij}\right)\tan\psi\label{eqn:const11}
\end{equation}

In addition to the yield function and the flow rule, the hardening rule is assumed to take the form of the Barcelona model \cite{lubliner_plastic-damage_1989}. The Barcelona model allows for material hardening before softening and approaches a yield stress of 0 as the plastic strain increases.  This form of the hardening function can be written in terms of three material paramters, initial compressive yield strength $Y_0$, $\alpha$ and $\beta$:

\begin{equation}
%\sigma_{c}\left(\bar{\epsilon}^{in}\right)=\frac{\sigma_{c}^{iy}-\sigma_{c}^{p}}{\left(\epsilon_{c}^{pp}\right)^{2}}\left(\bar{\epsilon}^{in}-\epsilon_{c}^{pp}\right)^{2}+\sigma_{c}^{p}
\sigma_c=Y_0\left [ \left ( 1+\alpha \right ) e^{-\beta\bar{\epsilon}^{pl}}-\alpha e^{-2\beta\bar{\epsilon}^{pl}}  \right ]
\label{eqn:param2-1}
\end{equation}

The damage initiation criterion for this material model was based off of the Johnson-Cook model of ductile damage initiation \cite{Johnson_1985}. The standard Johnson-Cook model assumes the equivalent plastic strain when damage is initiated, \bar{\epsilon}_{f}^{pl}\left(\eta\right), is a function of triaxiality, $\eta$, and is written in terms of five material parameters. However, assuming isothermal conditions, neglecting rate effects, and assuming a simplified form of the exponential relationship, the initiation criterion can be reduced to two material parameters, $D_2$ and $D_3$:

\begin{equation}
\bar{\epsilon}_{f}^{pl}\left(\eta\right)=D_{2}e^{D_{3}\eta}\label{eqn:druc8}
\end{equation}

After the material has experienced yield and material damage has occurred, the stress-strain relationship becomes strongly mesh-dependant due to strain localization due to the energy dissipation decreasing as the mesh is refined. As such, \citet{Hillerborg_1976} proposed a stress-displacement response based on fracture energy after damage initiation. The damage evolution used in this constitutive model assumes that damage is a progressively linear degradation of the material stiffness in compression. Assuming a linear form, the effective plastic displacement when the material is completely damaged, $\bar{u}^{pl}_f$, can be specified, and the damage evolution can then be written in terms of the effective plastic displacement, $\bar{u}^{pl}$:

\begin{equation}
\dot{D}=\frac{\dot{\bar{u}}^{pl}}{\bar{u}_{f}^{pl}}\label{eqn:druc9-1}
\end{equation}

