\subsection{Verification of the Parameter Estimation Module}

Using a PSO algorithm followed by an LMA optimization, the Drucker-Prager plasticity model with ductile damage was fitted to the homogenized DEM simulation data in order to obtain an optimal parameter set. Each simulation was fit to 50 points defining the homogenized resulting in a total of 200 data points for all four DEM simulations at different confining stresses. The PSO algorithm was run with a swarm size of 24 for 100 generations.

Parameter bounding limits are required by the optimization algorithms in order to limit the search space. These parameter values were chosen based on two criteria: physical limitations and numerical stability. If there existed physical limitations that prevent parameters from exceeding certain values or if there existed a range of realistic values that the parameter should not deviate from, then those physical limitations were specified as the bounds. In other cases, the parameter bounds came from numerical limitations such that beyond a certain capacity, certain parameter values would cause the simulations to become unstable. In these cases, a combination of the two bounding methods was used. The specified bounding limits for each parameter results can be seen in Table \ref{tab:paramDrucker}.

\begin{table}[!htbp]
\centering
\caption{Parameter Estimation Results for Drucker-Prager Model with Ductile Damage}
\label{tab:paramDrucker}
\begin{tabular}{@{}cccccc@{}}
\toprule
Parameter                                  & Symbol                            & Units      & Lower Bound & Upper Bound & Optimal Value \\ \midrule
Young's Modulus                            & $E$                               & $GPa$      & $1$         & $25$        & $1.79$        \\
Poisson's Ratio                            & $\nu$                             &            & $0.15$      & $0.45$      & $1.53$        \\
Dilation Angle                             & $\psi$                            & $^{\circ}$ & $5$         & $15$        & $22.4$        \\
Flow Stress Ratio                          & $K$                               &            & $0.78$      & $1$         & $0.81$        \\
Friction Angle                             & $\beta$                           & $^{\circ}$ & $45$        & $60$        & $56.0$        \\
Initial Compressive Yield Strength         & $\sigma_c^{iy}$                   & $kPa$      & $1$         & $100$       & $52.3$        \\
Peak Compressive Yield Strength  & $\sigma_c^{p}$                    & $MPa$      & $0.5$       & $5$         & $3.08$        \\
Strain at Peak Compressive Yield           & $\epsilon_c^{p}$                 & $\%$       & $0.5$       & $5$         & $1.65$        \\
Yeild Strain at -0.5 Triaxiality           & $\bar{\epsilon}^{pl}_{f_{-0.5}}$  & $\%$       & $0.01$      & $0.1$       & $0.0078$       \\
Yeild Strain at -0.75 Triaxiality          & $\bar{\epsilon}^{pl}_{f_{-0.75}}$ & $\%$       & $0.1$       & $10$        & $71.0$        \\
Plastic Displacement at Failure            & $\bar{u}^{pl}_f$                  & $m$        & $0.01$      & $1$         & $0.17$      \\ \bottomrule
\end{tabular}
\end{table}

The stress-strain curves from the DEM simulations used for the parameter estimation and the stress-strain curves of the CDM simulations using the optimal parameter set are presented in Figure \ref{fig:fitted1}. Here, it can be seen that the CDM fit is very good with a Root-Mean-Square Error (RMSE) of $1.47MPa$. It can be seen that the pressure dependent yield function works very well with this model as the error is not biased to curves of a certain confining stress. This fit implies a strong likely hood that the model will be valid under confining stresses outside of the range fitted. In addition, the damage initiation points at the peak of the curve also show a very strong correlation and indicate that the triaxiality based damage initiation criterion is a good model for this problem. The majority of the error in the curves comes from the post-yield behaviour. This error results from limitations in the continuum constitutive model since the post-yield behaviour of the DEM simulations is noisy due to discontinuous nature of the failure in the DEM simulations. The CDM model cannot account for these subtle oscillations and thus represents the post-yield response as an average. 
