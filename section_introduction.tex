\section{Introduction}
Naturally Fractured Rock (NFR) is often modeled as a multiscale material due to the vastly different length and time scales involved in the deformation process \citep{zhou_flow_2003}. At the fracture scale (10\textsuperscript{-3} m), the physics is dominated by brittle fracture propagation and fracture-to-fracture contact force interaction, while one is normally interested in the reservoir scale (10\textsuperscript{3} m) response as a result of the spatial extension of the fractures. Because these length scales of interest span approximately six orders of magnitude (not to mention time-scales), multiscale methods are required to assess the overall response as models with natural fracture scale resolution at the reservoir scale becomes computationally prohibitive.

The most common types multiscale methods are hierarchical and concurrent \citep{Gracie_2011}. In concurrent multiscale models, different scales are used in different regions of the domain; the solution of the coupled model proceeds by solving both scales simultaneously. This approach is very expensive since the time step of the whole simulation is controlled by the fine-scale model; however, thle solution is often more accurate.  In hierarchical multiscale methods, the constitutive behavior at the coarser scale is determined by exercising a finer scale Representative Elementary Volume (REV). The finer scale models vary from relatively simple models, as in micromechanics, to complex nonlinear models at in FE\textsuperscript{2} models\citep{Feyel_2003}. This approach is much more efficient, but can be less accurate, and furthermore  presents challenges when the REV loses stability \citep{Belytschko_2008}. Up-scaling in this investigation can be considered to be a hierarchical multiscale method using computational homogenization. 

Many homogenization techniques have been developed and proposed in the past, but none have presented algorithms for homogenizing DEM simulations with deformable blocks. The homogenization algorithms presented here are based off the work done by \citet{daddetta_particle_2004} and \citet{wellmann_homogenization_2008} which homogenize DEM simulations with rigid bodies. These methodologies however have several key differences that cannot be applied to DEM simulations with deformable blocks.

When dealing with reservoir scale geomechanics problems, pre-existing fractures become very influential on the constitutive response of the rock mass. However, attempting to capture the constitutive response of the NFR in a laboratory context becomes impractical due primarily to the prohibitively large samples required to obtain a representative response. Since natural fracture spacing can be between $0.1$ m to $1$m \cite{Nelson_2001}. The size of physical samples required to obtain a response representative of the macroscale could be as large as $1000 m^3$, which makes extraction, preparation and loading of the samples borderline impossible and very costly. 

There exist methods to estimate these constitutive parameters in rock masses, but the validity can be tenuous and methods exist only to estimate some of the parameters. These testing methods can either be conducted directly from in-situ geophysical measurements, or indirectly through small scale laboratory testing. A common in-situ test for estimating the elastic properties is through the use of seismic methods by comparing the seismic wave velocities measured in-situ to the seismic velocities of the intact rock mass \citep{SJOGREN_1979}. These in-situ methods however, do not have the capacity to estimate the plastic parameters very well. As such, attempts to estimate the plastic properties of the rock mass through small scale lab testing and qualitative assessments of the rock mass have been proposed such as the Geological Strength Index (GSI) proposed by \citet{Hoek_1997}. These methods are limited by the necessarily qualitative aspect of the rock mass classification. More recently, others \citep{Min_2003,Chen_2012,Bidgoli_2013} have used numerical methods to estimate the elastic properties of the rock mass using prescribed fracture networks. These methods are again, limited by the lack of plastic behaviour characterization. 

To address this limitation of continuum models, Discrete Element Method (DEM) models are used commonly in geomechanics to explicitly model the mechanics of Naturally Fractured Rock (NFR) masses to capture the constitutive response of the rock mass indirectly \citep{jing_review_2003}. 

DEM models, unlike standard continuum models, consider the fractures within the rock mass as a Discrete Fracture Network (DFN), which explicitly defines the geometry of the fracture network. The physics of block interaction is then governed by the motion, contact forces and traction-separation laws between the rock blocks and the fractures \citep{Thallak_1990}. Because NFR behavior is complex, even sophisticated phenomenological constitutive relationships may be inadequate to describe the complete rock mass behavior. The DEM approach aims to address this continuum behavioral deficiency by only requiring constitutive relations for the block interactions and the intact rock \cite{Barbosa_1990}. In this paper,  deformable DEM blocks are considered which require the constitutive parameters of the intact rock to be specified, but these parameters are more easily acquired from lab testing. 

However, the main issue with DEM models is primarily the computational demands. Due to the large number of degrees of freedom in the models and the requirement for very small time steps — because of the constant need for contact detection between blocks — running reservoir scale models is computationally prohibitive. The intent of this article is to develop a framework that incorporates the response of the DEM models while harnessing the computational speed of the continuum models. Up-scaling is accomplished in this paper by ‘calibrating’ a continuum model with DEM virtual experimental data using a combination of a heuristic optimization algorithm and an iterative least squares regression algorithm.

The general goal of up-scaling is to formulate simplified coarse-scale governing equations that approximate the fine-scale behavior of a material \citep{Geers_2010}. In the case of the DEM simulations in this investigation, the aim of up-scaling is to identify the parameters of a continuum model that best mimics the response of the DEM model.


