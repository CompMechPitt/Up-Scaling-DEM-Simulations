\subsection{Concrete Damaged-Plasticity}
%The CDM model used in this investigation is the concrete damaged plasticity
%model that is implemented in ABAQUS, which is based on the plastic-damage
%model for concrete proposed by \citet{lubliner_plastic-damage_1989} and further
%developed by \citet{lee_plastic-damage_1998} for cyclic loading. The general
%CDM theory considers the stiffness degradation of the material by
%modifying the elastic stiffness tensor with a damage variable. The
%damage variable can be scalar or tensorial in nature, depending on
%the anisotropy of damage evolution. In this investigation, the isotropic
%case is considered and so a scalar damage variable becomes sufficient.

%The parameters of the CDM that were calibrated from DEM simulations
%characterize the elastic and the plastic behavior and the damage evolution.
%Young's modulus and Poisson's ratio parameterize the elastic behavior.
For the concrete damaged-plasticity model, the plastic behavior of the material is largely determined by the
parameters of the hardening rule. Different functions were used
to characterize hardening in tension and compression. The shape of
the curves were based on the laboratory data in \citet{wahalathantri_material_2011} and the aim was to mimic the curves with the least number of
parameters. The compressive hardening rule,$\sigma_{c}\left(\bar{\epsilon}^{in}\right)$,
was approximated using a quadratic function, as shown in Figure \ref{fig:conccomp}. The
quadratic function requires three parameters. It was found to be useful
to manipulate the standard quadratic equation form to allow for the
three parameters to have a physical meaning. This form of the approximation
becomes quite useful for the parameter estimation when applying bounding
limits:

\begin{equation}
\sigma_{c}\left(\bar{\epsilon}^{in}\right)=\frac{\sigma_{c}^{iy}-\sigma_{c}^{p}}{\left(\epsilon_{c}^{pp}\right)^{2}}\left(\bar{\epsilon}^{in}-\epsilon_{c}^{pp}\right)^{2}+\sigma_{c}^{p}\label{eqn:param2-1}
\end{equation}

Here, the compressive yield stress, $\sigma_{c}$, is written as function
of the inelastic strain, $\bar{\epsilon}^{in}$, and three additional
parameters. The three parameters are the initial compressive yield
stress ($\sigma_{c}^{iy}$), the peak compressive yield stress ($\sigma_{c}^{p}$),
and the plastic strain at the peak compressive yield stress ($\sigma_{c}^{iy}$).
The physical significance of each of these parameters can be seen
in Fig \ref{fig:conccomp}, where they define the y-intercept and the peak of the curve.

The tensile hardening rule has a fundamentally different behavior
than the compressive hardening rule, and was therefore approximated
using an exponential function (Fig \ref{fig:conctens}). The exponential function required
only two parameters to characterize the curve completely. The first
parameter was the initial tensile yield stress, $\sigma_{t}^{iy}$,
which defines the y-intercept of the curve, while the second parameter
was the tensile yield stress decay parameter,$\lambda$. These parameters
describe the relationship between the tensile yield stress, $\sigma_{t}$,
and the cracking strain, $\bar{\epsilon}^{ck}$, and has the form:

\begin{equation}
\sigma_{t}\left(\bar{\epsilon}^{ck}\right)=\sigma_{t}^{iy}e^{\lambda\bar{\epsilon}^{ck}}\label{eqn:param2}
\end{equation}


In addition to the hardening rules, the damage evolution equations must also be parameterized. The compressive damage, $D_c$, is assumed to be a linear function of the inelastic strain through a compressive damage rate parameter, $m$:

\begin{equation}
D_{c}\left(\bar{\epsilon}^{in}\right)=\bar{\epsilon}^{in}m\label{eqn:param3}
\end{equation}


The tensile damage ($D_{t}$) evolution is slightly less trivial,
but can also be characterized by a single parameter due to some constraints
imposed on the function by the nature of the damage parameter. In
tension, the damage evolution curve starts at the origin and asymptotically
approaches $D_{t}=1$ as $\bar{\epsilon}^{ck}\rightarrow\infty$.
As such, under this functional assumption, the only parameter required
to describe this relationship is the tensile damage rate parameter,
n:

\begin{equation}
D_{t}\left(\bar{\epsilon}^{ck}\right)=1-\frac{1}{\left(1+\bar{\epsilon}^{ck}\right)^{n}}\label{eqn:param4}
\end{equation}


Sample damage evolution curves for both tension and compression are
illustrated in Fig \ref{fig:concdam}, where one can see that the rate at which the
tensile damage evolves is far larger than the rate at which the compressive
damage evolves. The combination of the elastic parameters, the hardening
rule parameters, and the damage evolution parameters, yield a total
of nine parameters that must be identified by experiments or through
up-scaling to define the behavior of CDM model.

At this point, there are some parameter constraints for the damage evolution that need to be considered for numerical stability. In this model, The damage curves are specified in terms of inelastic strain and cracking strain which need to be converted into plastic strain for the analysis. The inelastic and cracking strains represent the same strain component but refer to compression and tension respectively. This inelastic/cracking strain can be considered as the theoretical plastic strain given that the material is in an undamaged state. The conversion from inelastic/cracking strain to plastic strain is a function of the damaged state at every increment so the :

\begin{equation}
\label{eqn:param11}
\begin{array}{c}
\bar{\epsilon}_{c}^{pl}=\bar{\epsilon}^{in}-\frac{D_{c}}{1-D_{c}}\frac{\sigma_{c}^{iy}}{E}\\
\bar{\epsilon}_{t}^{pl}=\bar{\epsilon}^{ck}-\frac{D_{t}}{1-D_{t}}\frac{\sigma_{t}^{iy}}{E}
\end{array}
\end{equation}


The numerical issues with this formulation arise due to the fact that it is very possible for the converted plastic strain to not be monotonically increasing with respect to the tensile damage. By having a damage evolution curve with a sufficiently steep slope, such that the second term in equation \ref{eqn:param11} increases faster than the first term, it becomes mathematically possible to have decreasing and/or negative plastic strains in the damage evolution definition. As such, the following conditions is applied to constrain the damage evolution to always yield monotonically increasing plastic strains as damage increases:

\begin{equation}
\label{eqn:param6-1}
\begin{array}{c}
\frac{d\bar{\epsilon}_{c}^{pl}}{dD_{c}}>0\\
\frac{d\bar{\epsilon}_{t}^{pl}}{dD_{t}}>0
\end{array}
\end{equation}


For the compressive damage evolution, we can substitute equation \ref{eqn:param3} into \ref{eqn:param11} to get the following expression of plastic strain as a function of the compressive damage rate parameter:

\begin{equation}
\bar{\epsilon}_{c}^{pl}=\bar{\epsilon}^{in}-\frac{\bar{\epsilon}^{in}m}{1-\bar{\epsilon}^{in}m}\frac{\sigma_{c}^{iy}}{E}\label{eqn:param12}
\end{equation}

Combining \ref{eqn:param12} and \ref{eqn:param6-1} yields the following expression governing the stability limit for the compressive damage rate parameter:

\begin{equation}
m<\frac{\sigma_{c}^{iy}+2E\bar{\epsilon}^{in}-\sqrt{\sigma_{c}^{iy}\left(\sigma_{c}^{iy}+4E\bar{\epsilon}^{in}\right)}}{2E\left(\bar{\epsilon}^{in}\right)^{2}}\label{eqn:param13}
\end{equation}

However, since this upper bound for $m$ is functional on several of the parameterization parameters, which are not constant, the upper bound varies depending on the other input parameters. Because of this, a compressive damage scaling factor, $d_c$, is introduced. In addition, the strain rate requires minimization of the funciton ***

\begin{equation}
m=d_{c}\frac{\sigma_{c}^{iy}+2E\bar{\epsilon}^{in}-\sqrt{\sigma_{c}^{iy}\left(\sigma_{c}^{iy}+4E\bar{\epsilon}^{in}\right)}}{2E\left(\bar{\epsilon}^{in}\right)^{2}}\label{eqn:param14}
\end{equation}


where the range of limits:

\begin{equation}
0<d_{c}<1\label{eqn:param15}
\end{equation}


Similarly for the conversion from cracking strain to tesnile plastic
strain: Substituting in the damage evolution equation:

\begin{equation}
\bar{\epsilon}_{t}^{pl}=\bar{\epsilon}^{ck}-\left[\left(1+\bar{\epsilon}^{ck}\right)^{n}-1\right]\frac{\sigma_{t}^{iy}}{E}\label{eqn:param5-1}
\end{equation}


Solving for $n$ yeilds the following inequality:

\begin{equation}
n<\frac{W\left(\frac{E\left(\bar{\epsilon}^{ck}+1\right)}{\sigma_{t}^{iy}}\ln\left(\bar{\epsilon}^{ck}+1\right)\right)}{\ln\left(\bar{\epsilon}^{ck}+1\right)}\label{eqn:param7}
\end{equation}


where $W\left(x\right)$is the Lambert W function defined implicitly as follows:

\begin{equation}
x=W\left(x\right)e^{W(x)}\label{eqn:param8}
\end{equation}


However, since the parameter estimation algorithm requires absolute
bounds, and the upper bound for the parameter $n$ is variable wrt
the state of the model, a scaling parameter, $d_{t}$ is introduced:

\begin{equation}
n=d_{t}\frac{W\left(\frac{E\left(\bar{\epsilon}^{ck}+1\right)}{\sigma_{t}^{iy}}\ln\left(\bar{\epsilon}^{ck}+1\right)\right)}{\ln\left(\bar{\epsilon}^{ck}+1\right)}\label{eqn:param9}
\end{equation}


where:

\begin{equation}
0<d_{t}<1\label{eqn:param10}
\end{equation}


such that the scaling parameter can considered to be ... word. This
constraint removes the numerical instability resulting from converstion
from cracking strain to plastic strain. 


\subsubsection{misc}

Converting form cracking strain to plastic strain:

\begin{equation}
\bar{\epsilon}_{t}^{pl}=\bar{\epsilon}^{ck}-\frac{D_{t}}{1-D_{t}}\frac{\sigma_{t}^{iy}}{E}\label{eqn:param5}
\end{equation}


In order for plastic strain to be monotonically increasing wrt tensile
damage, the following condition is applied:

\begin{equation}
\frac{d\bar{\epsilon}_{t}^{pl}}{dD_{t}}>0\label{eqn:param6}
\end{equation}
